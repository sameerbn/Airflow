import org.apache.spark.sql.Dataset;
import org.apache.spark.sql.Row;
import org.apache.spark.sql.SparkSession;
import org.apache.spark.sql.types.*;

public class AvroToParquetConverter {
    public static void main(String[] args) {

        SparkSession spark = SparkSession.builder()
                .appName("AvroToParquet")
                .master("local[*]")
                .getOrCreate();

        StructType schema = new StructType(new StructField[]{
                new StructField("TRIGRAM", DataTypes.StringType, true, Metadata.empty()),
                new StructField("DEALID", DataTypes.StringType, true, Metadata.empty()),
                new StructField("VERSIONID", DataTypes.StringType, true, Metadata.empty()),
                new StructField("REGULATIONNAME", DataTypes.StringType, true, Metadata.empty()),
                new StructField("ELIGIBILITYMSG", DataTypes.StringType, true, Metadata.empty()),
                new StructField("AUDITTIMESTAMP", DataTypes.StringType, true, Metadata.empty()),
                new StructField("ELIGIBLEFLAG", DataTypes.StringType, true, Metadata.empty()),
                new StructField("GCPP", DataTypes.StringType, true, Metadata.empty()),
                new StructField("REPORTINGCDEFLAG", DataTypes.StringType, true, Metadata.empty()),
                new StructField("EEFLAG", DataTypes.StringType, true, Metadata.empty()),
                new StructField("AGENCYLENDING", DataTypes.StringType, true, Metadata.empty()),
                new StructField("CREATIONDATE", DataTypes.StringType, true, Metadata.empty()),
                new StructField("FCAELIGIBLE", DataTypes.StringType, true, Metadata.empty()),
                new StructField("FCAELIGIBLECP", DataTypes.StringType, true, Metadata.empty()),
                new StructField("FCAGCP", DataTypes.StringType, true, Metadata.empty()),
                new StructField("FCAREPORTINGELIGIBLE", DataTypes.StringType, true, Metadata.empty()),
                new StructField("FCAREPORTINGELIGIBLECP", DataTypes.StringType, true, Metadata.empty()),
                new StructField("FCACEB", DataTypes.StringType, true, Metadata.empty())
        });

        Dataset<Row> avroDF = spark.read()
                .format("avro")
                .schema(schema)
                .load("file:///path/to/input.avro");

        avroDF.write()
                .mode("overwrite")
                .parquet("file:///path/to/output_parquet");

        spark.stop();
    }
}
